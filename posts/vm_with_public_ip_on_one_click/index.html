<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>From Zero to Shell: Spin up an AWS VM in One Click | sbezo.github.io</title>
<meta name="keywords" content="">
<meta name="description" content="How to automate a fresh new AWS server using Terraform and Python, triggered directly from SecureCRT">
<meta name="author" content="">
<link rel="canonical" href="https://sbezo.github.io/posts/vm_with_public_ip_on_one_click/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css" integrity="sha256-j&#43;ECM6cGvIfy4Is8&#43;XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://sbezo.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://sbezo.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://sbezo.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://sbezo.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://sbezo.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://sbezo.github.io/posts/vm_with_public_ip_on_one_click/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>


<script>
document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false}
        ]
    });
});
</script>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-X37ESW6JQL"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-X37ESW6JQL');
        }
      </script><meta property="og:url" content="https://sbezo.github.io/posts/vm_with_public_ip_on_one_click/">
  <meta property="og:site_name" content="sbezo.github.io">
  <meta property="og:title" content="From Zero to Shell: Spin up an AWS VM in One Click">
  <meta property="og:description" content="How to automate a fresh new AWS server using Terraform and Python, triggered directly from SecureCRT">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-02-12T14:35:45+00:00">
    <meta property="article:modified_time" content="2026-02-12T14:35:45+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="From Zero to Shell: Spin up an AWS VM in One Click">
<meta name="twitter:description" content="How to automate a fresh new AWS server using Terraform and Python, triggered directly from SecureCRT">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://sbezo.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "From Zero to Shell: Spin up an AWS VM in One Click",
      "item": "https://sbezo.github.io/posts/vm_with_public_ip_on_one_click/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "From Zero to Shell: Spin up an AWS VM in One Click",
  "name": "From Zero to Shell: Spin up an AWS VM in One Click",
  "description": "How to automate a fresh new AWS server using Terraform and Python, triggered directly from SecureCRT",
  "keywords": [
    
  ],
  "articleBody": "Motivation From time to time I really need linux server with fresh public IP address without any firewall rules in any direction.\nOnce I need to upload/download something via SFTP/SCP.\nThen I need to scan something and want be sure, that my ISP doesn‚Äôt block some communication for good reasons‚Ä¶\nIt should be fresh, raw, unfiltered, isolated, temporary virtual machine in a wild internet.\nAnd as usually I want it quick and without any mental overhead:)\nSecurity disclaimer This setup is intentionally insecure by design. Never reuse these patterns for production or long-running servers. Use freely, if you know what you are doing;) Do not forget always to destroy VM after use\nSecureCRT integration I‚Äôve already wrote about using SecureCRT as my personal automation controller in my previous post, so without repeating myself:\nI have a buttons ‚ÄúStart SCP‚Äù and ‚ÄúDestroy SCP‚Äù in SecureCRT Each button has calls its ‚Äúcontroller‚Äù python script ‚Äúcontroller‚Äù script then call my executive python script (inside its venv and with its libraries) Controller script is very simple. It just open new terminal and call my executive script:\nimport subprocess import os cmd = \"/Users/stefanbezo/Documents/Dev/SCRT_2025/.venv/bin/python /Users/stefanbezo/Documents/Dev/SCRT_2025/SCP/init_scp_tf.py\" osascript_command = f''' tell application \"Terminal\" activate do script \"{cmd}\" end tell ''' subprocess.Popen([\"osascript\", \"-e\", osascript_command]) Main executive python script Executive script is much more interesting. But first structure of folder where scripts are placed.\nüìÅ SCP ‚îú‚îÄ‚îÄ üìÑ .gitignore ‚îú‚îÄ‚îÄ üìÑ init_scp_controller.py ‚îú‚îÄ‚îÄ üìÑ destroy_scp_controller.py ‚îú‚îÄ‚îÄ üìÑ init_scp_tf.py ‚îú‚îÄ‚îÄ üìÑ destroy_scp_tf.py ‚îú‚îÄ‚îÄ üìÑ last_instance_ip.txt ‚îú‚îÄ‚îÄ üìÑ main.tf ‚îî‚îÄ‚îÄ üìÑ variables.tf üìÑ .env üìÑ .key-pair-2025.pem Where .env holds sensitive information for AWS and will be loaded during script runtime.\nRSA key is already placed in AWS and file .key-pair-2025.pem will be used for programatic connection to new VM after creation.\nThe executive script init_scp_controller.py does following:\nLoad enironment variables call Terraform (like manually ‚Äúterraform apply‚Äù) gets new public IP from AWS connects to new VM Configure new user and SFTP/SCP service on new VM Prints all important info Here is full working executive python script:\nimport subprocess from dotenv import load_dotenv import os import time import paramiko load_dotenv(\"/Users/stefanbezo/Documents/Dev/SCRT_2025/.env\") # Copy current environment env = os.environ.copy() new_password = os.getenv(\"new_password\") # Path to your Terraform working directory tf_dir = \"/Users/stefanbezo/Documents/Dev/SCRT_2025/SCP\" # Initialize Terraform - just first time # subprocess.run([\"terraform\", \"init\"], cwd=tf_dir, check=True, env=env) # Apply subprocess.run([\"terraform\", \"apply\", \"-auto-approve\"], cwd=tf_dir, check=True, env=env) # Configure SCP # AWS CLI command cmd = [ \"aws\", \"ec2\", \"describe-instances\", \"--query\", \"Reservations[].Instances[] | sort_by(@, \u0026LaunchTime)[-1].PublicIpAddress\", \"--output\", \"text\" ] result = subprocess.run(cmd, env=env, capture_output=True, text=True, check=True) host = result.stdout.strip() time.sleep(20) user = \"ubuntu\" new_user = \"transfer\" key = \"/Users/stefanbezo/Documents/Dev/SCRT_2025/.key-pair-2025.pem\" commands = [ f\"echo 'PasswordAuthentication yes' | sudo tee /etc/ssh/sshd_config.d/*.conf\", f\"echo 'HostKeyAlgorithms +ssh-rsa' | sudo tee -a /etc/ssh/sshd_config.d/*.conf\", f\"echo 'PubkeyAcceptedAlgorithms +ssh-rsa' | sudo tee -a /etc/ssh/sshd_config.d/*.conf\", f\"sudo service ssh restart\", f\"sudo useradd -m -s /bin/bash {new_user}\", f'echo \"{new_user}:{new_password}\" | sudo chpasswd', f\"sudo usermod -aG sudo {new_user}\" ] client = paramiko.SSHClient() client.set_missing_host_key_policy(paramiko.AutoAddPolicy()) client.connect(host, username=user, key_filename=key) for cmd in commands: stdin, stdout, stderr = client.exec_command(cmd) print(stdout.read().decode(), stderr.read().decode()) client.close() print(f\"***********************************************************************\") print(f\"You can access new server by: \\nssh -i /Users/stefanbezo/Documents/Dev/SCRT_2025/.key-pair-2025.pem {user}@{host}\\n\") print(\"Upload: \") print(f\"scp /Users/stefanbezo/Downloads/some_file {new_user}@{host}:/home/{new_user}/\\n\") print(\"Download: \") print(f\"scp {new_user}@{host}:/home/{new_user}/some_file ./\\n\") print(f\"current password for user '{new_user}' is '{new_password}'\") Terraform And now Terraform part. It was eventually first part of whole workflow and I used it for manual terraform apply and terraform destroy actions.\nTerraform variables defines only access key to AWS for service account and load them from running evironment variables (loaded by python script before). Nothing special:\nvariable \"aws_access_key_id\" { description = \"AWS Access Key ID\" type = string } variable \"aws_access_key_access_key\" { description = \"AWS Access Key Secret\" type = string } .env file should contains access key in following form:\nTF_VAR_aws_access_key_id=your-access-key-id TF_VAR_aws_access_key_access_key=your-access-key And finally terraform.main without any necessary complications.\nJust defining:\nProvider, region, credentials necessary networking (new isolated VPC, Subnet, CIDR, Gateway, routing) some quite open policy (This is why I usually need it) Instructions for new VM (instance type, request public IP, use RSA keypair‚Ä¶) provider \"aws\" { region = \"eu-central-1\" access_key = var.aws_access_key_id secret_key = var.aws_access_key_access_key } resource \"aws_vpc\" \"Sandbox\" { cidr_block = \"10.10.0.0/16\" tags = { Name = \"Sandbox-VPC\" } } resource \"aws_subnet\" \"mgmt_subnet\" { vpc_id = aws_vpc.Sandbox.id cidr_block = \"10.10.1.0/24\" availability_zone = \"eu-central-1a\" tags = { Name = \"mgmt_subnet-eu-central-1a\" } } resource \"aws_security_group\" \"Sandbox-Security-Group\" { name = \"Sandbox-Security-Group\" description = \"Security group for Sandbox VM\" vpc_id = aws_vpc.Sandbox.id tags = { Name = \"Sandbox-Security-Group\" } ingress { from_port = 0 to_port = 0 protocol = \"All\" cidr_blocks = [\"0.0.0.0/0\"] } egress { from_port = 0 to_port = 0 protocol = \"All\" cidr_blocks = [\"0.0.0.0/0\"] } } # Create an Internet Gateway resource \"aws_internet_gateway\" \"Sandbox-Internet-Gateway\" { vpc_id = aws_vpc.Sandbox.id tags = { Name = \"Sandbox-Internet-Gateway\" } } # Create a Route Table for the VPC resource \"aws_route_table\" \"Sandbox-Route-Table\" { vpc_id = aws_vpc.Sandbox.id tags = { Name = \"Sandbox-Route-Table\" } } # Add a Route to the Internet Gateway in the Route Table resource \"aws_route\" \"Sandbox-Route\" { route_table_id = aws_route_table.Sandbox-Route-Table.id destination_cidr_block = \"0.0.0.0/0\" gateway_id = aws_internet_gateway.Sandbox-Internet-Gateway.id } # Associate the Management Route Table with the Subnet resource \"aws_route_table_association\" \"Sandbox-Route-Table-Association\" { subnet_id = aws_subnet.mgmt_subnet.id route_table_id = aws_route_table.Sandbox-Route-Table.id } resource \"aws_instance\" \"Sandbox\" { ami = \"ami-03250b0e01c28d196\" instance_type = \"t2.micro\" subnet_id = aws_subnet.mgmt_subnet.id security_groups = [aws_security_group.Sandbox-Security-Group.id] availability_zone = \"eu-central-1a\" associate_public_ip_address = true key_name = \"key-pair-2025\" tags = { Name = \"Sandbox\" } lifecycle { ignore_changes = [ security_groups, ] } metadata_options { http_tokens = \"required\" # Enforce IMDSv2 http_put_response_hop_limit = 1 # Limit metadata access to the instance itself http_endpoint = \"enabled\" } } And in less than 30 seconds I get exactly following shell: Cleanup Do not forget to create also ‚Äúterraform destroy‚Äù part and use it ! ;)\n",
  "wordCount" : "938",
  "inLanguage": "en",
  "datePublished": "2026-02-12T14:35:45Z",
  "dateModified": "2026-02-12T14:35:45Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://sbezo.github.io/posts/vm_with_public_ip_on_one_click/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "sbezo.github.io",
    "logo": {
      "@type": "ImageObject",
      "url": "https://sbezo.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://sbezo.github.io/" accesskey="h" title="sbezo.github.io (Alt + H)">sbezo.github.io</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://sbezo.github.io/posts/" title="Posts">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="https://sbezo.github.io/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      From Zero to Shell: Spin up an AWS VM in One Click
    </h1>
    <div class="post-meta"><span title='2026-02-12 14:35:45 +0000 UTC'>February 12, 2026</span>

</div>
  </header> 
  <div class="post-content"><h2 id="motivation">Motivation<a hidden class="anchor" aria-hidden="true" href="#motivation">#</a></h2>
<p>From time to time I really need linux server with fresh public IP address without any firewall rules in any direction.<br>
Once I need to upload/download something via SFTP/SCP.<br>
Then I need to scan something and want be sure, that my ISP doesn&rsquo;t block some communication for good reasons&hellip;<br>
It should be fresh, raw, unfiltered, isolated, temporary virtual machine in a wild internet.</p>
<p>And as usually I want it quick and without any mental overhead:)</p>
<h2 id="security-disclaimer">Security disclaimer<a hidden class="anchor" aria-hidden="true" href="#security-disclaimer">#</a></h2>
<blockquote>
<p>This setup is intentionally insecure by design.
Never reuse these patterns for production or long-running servers.
Use freely, if you know what you are doing;)
Do not forget always to destroy VM after use</p></blockquote>
<h2 id="securecrt-integration">SecureCRT integration<a hidden class="anchor" aria-hidden="true" href="#securecrt-integration">#</a></h2>
<p>I&rsquo;ve already wrote about using SecureCRT as my personal automation controller in my previous <a href="/posts/VM_with_public_IP_on_one_click.md/">post</a>, so without repeating myself:</p>
<ul>
<li>I have a buttons &ldquo;Start SCP&rdquo; and &ldquo;Destroy SCP&rdquo; in SecureCRT</li>
<li>Each button has calls its &ldquo;controller&rdquo; python script</li>
<li>&ldquo;controller&rdquo; script then call my executive python script (inside its venv and with its libraries)</li>
</ul>
<p>Controller script is very simple. It just open new terminal and call my executive script:</p>
<pre tabindex="0"><code>import subprocess
import os

cmd = &#34;/Users/stefanbezo/Documents/Dev/SCRT_2025/.venv/bin/python /Users/stefanbezo/Documents/Dev/SCRT_2025/SCP/init_scp_tf.py&#34;

osascript_command = f&#39;&#39;&#39;
tell application &#34;Terminal&#34;
    activate
    do script &#34;{cmd}&#34;
end tell
&#39;&#39;&#39;

subprocess.Popen([&#34;osascript&#34;, &#34;-e&#34;, osascript_command])
</code></pre><h2 id="main-executive-python-script">Main executive python script<a hidden class="anchor" aria-hidden="true" href="#main-executive-python-script">#</a></h2>
<p>Executive script is much more interesting. But first structure of folder where scripts are placed.</p>
<pre tabindex="0"><code>üìÅ SCP   
‚îú‚îÄ‚îÄ üìÑ .gitignore   
‚îú‚îÄ‚îÄ üìÑ init_scp_controller.py   
‚îú‚îÄ‚îÄ üìÑ destroy_scp_controller.py   
‚îú‚îÄ‚îÄ üìÑ init_scp_tf.py   
‚îú‚îÄ‚îÄ üìÑ destroy_scp_tf.py   
‚îú‚îÄ‚îÄ üìÑ last_instance_ip.txt  
‚îú‚îÄ‚îÄ üìÑ main.tf   
‚îî‚îÄ‚îÄ üìÑ variables.tf   
üìÑ .env   
üìÑ .key-pair-2025.pem   
</code></pre><p>Where .env holds sensitive information for AWS and will be loaded during script runtime.<br>
RSA key is already placed in AWS and file .key-pair-2025.pem will be used for programatic connection to new VM after creation.</p>
<p>The executive script <code>init_scp_controller.py</code> does following:</p>
<ul>
<li>Load enironment variables</li>
<li>call Terraform (like manually &ldquo;terraform apply&rdquo;)</li>
<li>gets new public IP from AWS</li>
<li>connects to new VM</li>
<li>Configure new user and SFTP/SCP service on new VM</li>
<li>Prints all important info</li>
</ul>
<p>Here is full working executive python script:</p>
<pre tabindex="0"><code>import subprocess
from dotenv import load_dotenv
import os
import time
import paramiko

load_dotenv(&#34;/Users/stefanbezo/Documents/Dev/SCRT_2025/.env&#34;)
# Copy current environment
env = os.environ.copy()
new_password = os.getenv(&#34;new_password&#34;)

# Path to your Terraform working directory
tf_dir = &#34;/Users/stefanbezo/Documents/Dev/SCRT_2025/SCP&#34;

# Initialize Terraform - just first time
# subprocess.run([&#34;terraform&#34;, &#34;init&#34;], cwd=tf_dir, check=True, env=env)

# Apply
subprocess.run([&#34;terraform&#34;, &#34;apply&#34;, &#34;-auto-approve&#34;], cwd=tf_dir, check=True, env=env)

# Configure SCP
# AWS CLI command
cmd = [
    &#34;aws&#34;, &#34;ec2&#34;, &#34;describe-instances&#34;,
    &#34;--query&#34;, &#34;Reservations[].Instances[] | sort_by(@, &amp;LaunchTime)[-1].PublicIpAddress&#34;,
    &#34;--output&#34;, &#34;text&#34;
]

result = subprocess.run(cmd, env=env, capture_output=True, text=True, check=True)

host = result.stdout.strip()
time.sleep(20)

user = &#34;ubuntu&#34;
new_user = &#34;transfer&#34;
key = &#34;/Users/stefanbezo/Documents/Dev/SCRT_2025/.key-pair-2025.pem&#34;
commands = [
    f&#34;echo &#39;PasswordAuthentication yes&#39; | sudo tee /etc/ssh/sshd_config.d/*.conf&#34;,
    f&#34;echo &#39;HostKeyAlgorithms +ssh-rsa&#39; | sudo tee -a /etc/ssh/sshd_config.d/*.conf&#34;,
    f&#34;echo &#39;PubkeyAcceptedAlgorithms +ssh-rsa&#39; | sudo tee -a /etc/ssh/sshd_config.d/*.conf&#34;,
    f&#34;sudo service ssh restart&#34;,
    f&#34;sudo useradd -m -s /bin/bash {new_user}&#34;,
    f&#39;echo &#34;{new_user}:{new_password}&#34; | sudo chpasswd&#39;,
    f&#34;sudo usermod -aG sudo {new_user}&#34;
]

client = paramiko.SSHClient()
client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
client.connect(host, username=user, key_filename=key)

for cmd in commands:
    stdin, stdout, stderr = client.exec_command(cmd)
    print(stdout.read().decode(), stderr.read().decode())

client.close()

print(f&#34;***********************************************************************&#34;)
print(f&#34;You can access new server by: \nssh -i /Users/stefanbezo/Documents/Dev/SCRT_2025/.key-pair-2025.pem {user}@{host}\n&#34;)

print(&#34;Upload: &#34;)
print(f&#34;scp /Users/stefanbezo/Downloads/some_file {new_user}@{host}:/home/{new_user}/\n&#34;)

print(&#34;Download: &#34;)
print(f&#34;scp {new_user}@{host}:/home/{new_user}/some_file ./\n&#34;)

print(f&#34;current password for user &#39;{new_user}&#39; is &#39;{new_password}&#39;&#34;)
</code></pre><h2 id="terraform">Terraform<a hidden class="anchor" aria-hidden="true" href="#terraform">#</a></h2>
<p>And now Terraform part. It was eventually first part of whole workflow and I used it for manual <code>terraform apply</code> and <code>terraform destroy</code> actions.</p>
<p>Terraform variables defines only access key to AWS for service account and load them from running evironment variables (loaded by python script before). Nothing special:</p>
<pre tabindex="0"><code>variable &#34;aws_access_key_id&#34; {
  description = &#34;AWS Access Key ID&#34;
  type        = string
}

variable &#34;aws_access_key_access_key&#34; {
  description = &#34;AWS Access Key Secret&#34;
  type        = string
}
</code></pre><p><code>.env</code> file should contains access key in following form:</p>
<pre tabindex="0"><code>TF_VAR_aws_access_key_id=your-access-key-id
TF_VAR_aws_access_key_access_key=your-access-key
</code></pre><p>And finally <code>terraform.main</code> without any necessary complications.<br>
Just defining:</p>
<ul>
<li>Provider, region, credentials</li>
<li>necessary networking (new isolated VPC, Subnet, CIDR, Gateway, routing)</li>
<li>some quite open policy (This is why I usually need it)</li>
<li>Instructions for new VM (instance type, request public IP, use RSA keypair&hellip;)</li>
</ul>
<pre tabindex="0"><code>provider &#34;aws&#34; {
  region = &#34;eu-central-1&#34;
  access_key = var.aws_access_key_id
  secret_key = var.aws_access_key_access_key
}

resource &#34;aws_vpc&#34; &#34;Sandbox&#34; {
  cidr_block = &#34;10.10.0.0/16&#34;
  tags = {
    Name     = &#34;Sandbox-VPC&#34;
  }
}

resource &#34;aws_subnet&#34; &#34;mgmt_subnet&#34; {
  vpc_id            = aws_vpc.Sandbox.id
  cidr_block        = &#34;10.10.1.0/24&#34;
  availability_zone = &#34;eu-central-1a&#34;
  tags = {
    Name            = &#34;mgmt_subnet-eu-central-1a&#34;
  }
}


resource &#34;aws_security_group&#34; &#34;Sandbox-Security-Group&#34; {
  name        = &#34;Sandbox-Security-Group&#34;
  description = &#34;Security group for Sandbox VM&#34;
  vpc_id      = aws_vpc.Sandbox.id
  tags = {
    Name = &#34;Sandbox-Security-Group&#34;
  }
  
  ingress {
    from_port   = 0
    to_port     = 0
    protocol    = &#34;All&#34;
    cidr_blocks = [&#34;0.0.0.0/0&#34;]
  }
  egress {
    from_port   = 0
    to_port     = 0
    protocol    = &#34;All&#34;
    cidr_blocks = [&#34;0.0.0.0/0&#34;]
  }
}

# Create an Internet Gateway
resource &#34;aws_internet_gateway&#34; &#34;Sandbox-Internet-Gateway&#34; {
  vpc_id = aws_vpc.Sandbox.id
  tags = {
    Name = &#34;Sandbox-Internet-Gateway&#34;
  }
}

# Create a Route Table for the VPC
resource &#34;aws_route_table&#34; &#34;Sandbox-Route-Table&#34; {
  vpc_id = aws_vpc.Sandbox.id
  tags = {
    Name = &#34;Sandbox-Route-Table&#34;
  }
}

# Add a Route to the Internet Gateway in the Route Table
resource &#34;aws_route&#34; &#34;Sandbox-Route&#34; {
  route_table_id         = aws_route_table.Sandbox-Route-Table.id
  destination_cidr_block = &#34;0.0.0.0/0&#34;
  gateway_id             = aws_internet_gateway.Sandbox-Internet-Gateway.id
}

# Associate the Management Route Table with the Subnet
resource &#34;aws_route_table_association&#34; &#34;Sandbox-Route-Table-Association&#34; {
  subnet_id      = aws_subnet.mgmt_subnet.id
  route_table_id = aws_route_table.Sandbox-Route-Table.id
}

resource &#34;aws_instance&#34; &#34;Sandbox&#34; {
  ami                    = &#34;ami-03250b0e01c28d196&#34;
  instance_type          = &#34;t2.micro&#34;
  subnet_id              = aws_subnet.mgmt_subnet.id
  security_groups        = [aws_security_group.Sandbox-Security-Group.id]
  availability_zone      = &#34;eu-central-1a&#34;
  associate_public_ip_address = true

  key_name               = &#34;key-pair-2025&#34;  
  tags = {
    Name = &#34;Sandbox&#34;
  }
    lifecycle {
    ignore_changes = [
      security_groups,
    ]
  }
  metadata_options {
    http_tokens               = &#34;required&#34; # Enforce IMDSv2
    http_put_response_hop_limit = 1       # Limit metadata access to the instance itself
    http_endpoint             = &#34;enabled&#34;
  }
}
</code></pre><p>And in less than 30 seconds I get exactly following shell:
<img loading="lazy" src="/img/vm_with_public_ip_01.png"></p>
<h2 id="cleanup">Cleanup<a hidden class="anchor" aria-hidden="true" href="#cleanup">#</a></h2>
<blockquote>
<p>Do not forget to create also &ldquo;terraform destroy&rdquo; part and use it ! ;)</p></blockquote>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>

<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share From Zero to Shell: Spin up an AWS VM in One Click on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsbezo.github.io%2fposts%2fvm_with_public_ip_on_one_click%2f&amp;title=From%20Zero%20to%20Shell%3a%20Spin%20up%20an%20AWS%20VM%20in%20One%20Click&amp;summary=From%20Zero%20to%20Shell%3a%20Spin%20up%20an%20AWS%20VM%20in%20One%20Click&amp;source=https%3a%2f%2fsbezo.github.io%2fposts%2fvm_with_public_ip_on_one_click%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share From Zero to Shell: Spin up an AWS VM in One Click on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fsbezo.github.io%2fposts%2fvm_with_public_ip_on_one_click%2f&title=From%20Zero%20to%20Shell%3a%20Spin%20up%20an%20AWS%20VM%20in%20One%20Click">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://sbezo.github.io/">sbezo.github.io</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
