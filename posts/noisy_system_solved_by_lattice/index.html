<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Noisy system solved by Lattice | sbezo.github.io</title>
<meta name="keywords" content="">
<meta name="description" content="Lattices - Part 3: How to use Lattice to break LWE system with small errors.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/noisy_system_solved_by_lattice/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css" integrity="sha256-j&#43;ECM6cGvIfy4Is8&#43;XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/noisy_system_solved_by_lattice/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous">

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js" integrity="sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY" crossorigin="anonymous"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js" integrity="sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>


<script>
document.addEventListener("DOMContentLoaded", function() {
    renderMathInElement(document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "$", right: "$", display: false}
        ]
    });
});
</script>


      <script async src="https://www.googletagmanager.com/gtag/js?id=G-X37ESW6JQL"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-X37ESW6JQL');
        }
      </script><meta property="og:url" content="http://localhost:1313/posts/noisy_system_solved_by_lattice/">
  <meta property="og:site_name" content="sbezo.github.io">
  <meta property="og:title" content="Noisy system solved by Lattice">
  <meta property="og:description" content="Lattices - Part 3: How to use Lattice to break LWE system with small errors.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-08-16T14:35:18+00:00">
    <meta property="article:modified_time" content="2025-08-16T14:35:18+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Noisy system solved by Lattice">
<meta name="twitter:description" content="Lattices - Part 3: How to use Lattice to break LWE system with small errors.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "http://localhost:1313/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Noisy system solved by Lattice",
      "item": "http://localhost:1313/posts/noisy_system_solved_by_lattice/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Noisy system solved by Lattice",
  "name": "Noisy system solved by Lattice",
  "description": "Lattices - Part 3: How to use Lattice to break LWE system with small errors.",
  "keywords": [
    
  ],
  "articleBody": "Learning with errors (LWE) is one of the cornerstone problems in modern lattice-based cryptography and algorithms based on LWE are most promising for post-quantum cryptography era.\nI’m going to start this post with explanation of principles of LWE and then as usually in this series I’ll setup a challenge which I try to solve by Lattice and LLL algorithm. And again - I’m going to focus on process of practical creating of Lattice of course;)\nSystem of linear equations. To be on the same page, I’d like to explain how to solve system of linear equations by matrix in Sagemath. Say that we have following system of just 4 equations with 4 unknowns:\n$4a_1 + 5a_2 + 2a_3 + 7a_4 = 48$\n$7a_1 + 6a_2 + 4a_3 + 3a_4 = 43$\n$5a_1 + 2a_2 + 0a_3 + 3a_4 = 21$\n$9a_1 + 6a_2 + 4a_3 + 2a_4 = 41$\nIn sage we can define left side of system as matrix $A$:\nA = matrix(( [4, 5, 2, 7], [7, 6, 4, 3], [5, 2, 0, 3], [9, 6, 4, 2], )) Right side we can define as vector $b$:\nb = vector([48,43,21,41]) Now we can find solution by sage operation:\nA.solve_right(b) And output is:\n(1, 2, 3, 4) Which is solution of given equations system. We can check first equation.\n4*1 + 5*2 + 2*3 + 7*4 48 It is ok and I believe sage in this.\nSwitching to modulo. Next step will be moving our linear system to modulo universe.\nWe need to define matrix over some integer ring. We can choose a simple integer modulo, or Gaussian field over prime. It doesn’t matter in this case, but let stay on safer side and choose modulo as a prime number and Gaussian Field for our next calculations. Choose modulo q = 23 and then matrix will be defined like this:\nq = 23 A_gf = matrix(GF(q), ( [4, 5, 2, 7], [7, 6, 4, 3], [5, 2, 0, 3], [9, 6, 4, 2], )) Multiply it by expected solution:\nA_gf * vector(GF(q), [1, 2, 3, 4]) (2, 20, 21, 18) And we get right side. And congruences (not equations anymore) will looks like:\n$4a_1 + 5a_2 + 2a_3 + 7a_4 \\equiv 2 \\space\\space mod(23)$\n$7a_1 + 6a_2 + 4a_3 + 3a_4 \\equiv 20 \\space\\space mod(23)$\n$5a_1 + 2a_2 + 0a_3 + 3a_4 \\equiv 21 \\space\\space mod(23)$\n$9a_1 + 6a_2 + 4a_3 + 2a_4 \\equiv 18 \\space\\space mod(23)$\nWe can check the first row:\n(4*1 + 5*2 + 2*3 + 7*4) % 23 2 And it is ok.\nLet check also 2. row for those who are more suspicious.\n(7*1 + 7*2 + 4*3 +3*4) % 23 22 And it still holds.\nWe can employ sage’s solver to check complete congruence system:\nb_gf = vector(GF(q), [2, 20, 21, 18]) A_gf.solve_right(b_gf) And output is as expected:\n(1, 2, 3, 4) This was necessary introduction to solving linear equations and linear congruences by sage.\nAnd we are ready to move to LWE now.\nLWE introduction Add 2 more congruences to our system to make it a bit overdetermined.\n$4a_1 + 5a_2 + 2a_3 + 7a_4 \\equiv 2 \\space\\space mod(23)$\n$7a_1 + 6a_2 + 4a_3 + 3a_4 \\equiv 20 \\space\\space mod(23)$\n$5a_1 + 2a_2 + 0a_3 + 3a_4 \\equiv 21 \\space\\space mod(23)$\n$9a_1 + 6a_2 + 4a_3 + 2a_4 \\equiv 18 \\space\\space mod(23)$\n$3a_1 + 5a_2 + 7a_3 + 9a_4 \\equiv 1 \\space\\space mod(23)$\n$0a_1 + 3a_2 + 6a_3 + 9a_4 \\equiv 14 \\space\\space mod(23)$\nA_gf = A_gf.stack(matrix(GF(q),([3, 5, 7, 9], [0, 3, 6, 9]))) A_gf * vector(GF(q), [1, 2, 3, 4]) # gives: (2, 20, 21, 18, 1, 14) b_gf = vector(GF(q), [2, 20, 21, 18, 1, 14]) A_gf.solve_right(b_gf) # gives again: (1, 2, 3, 4) System holds and everything is consistent.\nBut now try to inject small error to right side. Just change $2$ to $3$ in the first row.\nAnd now try to solve by sage’s solver:\nb_gf_err = vector(GF(q), [3, 20, 21, 18, 1, 14]) A_gf.solve_right(b_gf_err) And we get error:\nValueError: matrix equation has no solutions Expected. But the question is, if we are able to solve such intently broken overdetermined congruence system? Indeed, it is a hard problem. Exactly what crypto systems need.\nHow hard depends on scale of errors and number of unknowns in congruence system.\nOk, and as in other crypto systems, we need public key, private key, plaintext message and encrypted message.\nSo what is what in LWE? It is not as clear as in other crypto schemes but following is pretty close for better imagination:\nPublic key is a matrix - integer coefficients on left side of noisy congruence system.\nPrivate secret key is vector of unknowns. $a_1, a_2, a_3, a_4$ in our case. We worked with 1, 2, 3, 4.\nPlaintext secret message is vector of errors, which are injected to integers on right side.\nAnd right side we can consider as cipher message.\nWith knowledge of private key (vector of unknowns of congruences system) is it straightforward to solve the system. Difference between output on right side and provided solution (secret cipher message) is exactly error vector, which is plaintext message.\nWithout knowledge of private key, we have to try to solve noisy congruence system and try to identify injected errors.\nEverything will be more clear in following real example.\nCreating LWE system I’m going to create and solve noisy overdetermined LWE system. Let choose something bigger, but still solvable by Lattice.\nChallenge 3 Create noisy system with encoded message first\nLet generate matrix with 64 columns and 96 rows with random coefficients over field $q = 2^{16} + 1$.\nThis matrix is a Public key.\nLet generate Private key as vector of 64 random numbers.\nLet choose plaintext message “HelloLattice” and encode it as 0 and 1 to error vector.\nCalculate correct right side of system by multiplying matrix with secret vector. Inject error vector to system.\nChallenge task:\nTry to break system and decode plaintext without knowledge of private key.\nFirst part is straightforward. Just follow challenge steps to create noisy system:\nq = 2**16 + 1 m = 96 # rows n = 64 # columns # public key as matrix 96x64 A = Matrix(GF(q), m, n, lambda i, j: randint(0, q)) # private key as vector of 64 numbers: s = vector(Matrix(GF(q), 1, n, lambda i, j: randint(0, q))) # define plaintext message and encode it to error vector e: message = \"HelloLattice\" bits = [int(b) for c in message.encode(\"utf-8\") for b in f\"{c:08b}\"] e = vector(GF(q), bits) # calculate correct right side of system: b_correct = A * s # and finally inject errors by adding correct right side and error vector: b = b_correct + e You can check all variables, but they are quite big, so I do not write outputs here.\nWith knowledge of private key the solution should be easy.\n$e = b - A * s$\nShould give us cleartext message encoded in 0 and 1.\nLet try it:\n# calculate error vector - binary encoded message e_exp = b - A * s # and now try to decode byte_values = [] for i in range(0, len(e_exp), 8): byte = int(\"\".join(str(b) for b in e_exp[i:i+8]), 2) byte_values.append(byte) print(\"Decoded message: \", bytes(byte_values).decode(\"utf-8\", errors=\"ignore\")) And you should get correct plaintext message.\nNow we continue with hardest way. We are going to recover message without knowledge of private key s. And again we will utilize Lattice.\nSolving noisy LWE system by Lattice We know just system of linear equations (more precisely congruences), where right side tampered by errors. We know that error could be 1 or 0, so very small divergence from correct results. Nothing else. This error vector is encoded plaintext message. So we want to find it. In this case error vector is 96 bits long. Even errors are small, it is still $2^{96}$ possibilities, which is completely infeasible by brute force method.\nBut keywords very small divergence from previous evaluation could lead us again to our topic - Lattice.\nIf LLL method can discover smallest non-zero vector in given Lattice, it could find unknown error vector.\nA_zz = matrix(ZZ, A) b_zz = vector(ZZ, b) A_aug = A_zz.augment(b_zz).augment(diagonal_matrix(ZZ, [q] * m)).T A_lll = A_aug.LLL() for row in A_lll: if row != 0 and all(abs(x) \u003c= 1 for x in row): break # solve the system e_exp = vector(Integers(q), row) try: s_v = A.solve_right(b - e_exp) print(f\"*** System solvable: e = {e_exp}\") except: print(\"No solution found with LATTICE method.\") s_v = None byte_values = [] for i in range(0, len(e_exp), 8): byte = int(\"\".join(str(b) for b in e_exp[i:i+8]), 2) byte_values.append(byte) print(\"Decoded message: \", bytes(byte_values).decode(\"utf-8\", errors=\"ignore\")) ",
  "wordCount" : "1442",
  "inLanguage": "en",
  "datePublished": "2025-08-16T14:35:18Z",
  "dateModified": "2025-08-16T14:35:18Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://localhost:1313/posts/noisy_system_solved_by_lattice/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "sbezo.github.io",
    "logo": {
      "@type": "ImageObject",
      "url": "http://localhost:1313/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="sbezo.github.io (Alt + H)">sbezo.github.io</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/posts/" title="Posts">
                    <span>Blog</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Noisy system solved by Lattice
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h1>
    <div class="post-meta"><span title='2025-08-16 14:35:18 +0000 UTC'>August 16, 2025</span>

</div>
  </header> 
  <div class="post-content"><p>Learning with errors (LWE) is one of the cornerstone problems in modern lattice-based cryptography and algorithms based on LWE are most promising for post-quantum cryptography era.<br>
I&rsquo;m going to start this post with explanation of principles of LWE and then as usually in this series I&rsquo;ll setup a challenge which I try to solve by Lattice and LLL algorithm. And again - I&rsquo;m going to focus on process of practical creating of Lattice of course;)</p>
<h2 id="system-of-linear-equations">System of linear equations.<a hidden class="anchor" aria-hidden="true" href="#system-of-linear-equations">#</a></h2>
<p>To be on the same page, I&rsquo;d like to explain how to solve system of linear equations by matrix in Sagemath.
Say that we have following system of just 4 equations with 4 unknowns:</p>
<p>$4a_1 + 5a_2 + 2a_3 + 7a_4 = 48$<br>
$7a_1 + 6a_2 + 4a_3 + 3a_4 = 43$<br>
$5a_1 + 2a_2 + 0a_3 + 3a_4 = 21$<br>
$9a_1 + 6a_2 + 4a_3 + 2a_4 = 41$</p>
<p>In sage we can define left side of system as matrix $A$:</p>
<pre tabindex="0"><code>A = matrix((
    [4, 5, 2, 7],
    [7, 6, 4, 3],
    [5, 2, 0, 3],
    [9, 6, 4, 2],
))
</code></pre><p>Right side we can define as vector $b$:</p>
<pre tabindex="0"><code>b = vector([48,43,21,41])
</code></pre><p>Now we can find solution by sage operation:</p>
<pre tabindex="0"><code>A.solve_right(b)
</code></pre><p>And output is:</p>
<pre tabindex="0"><code>(1, 2, 3, 4)
</code></pre><p>Which is solution of given equations system. We can check first equation.</p>
<pre tabindex="0"><code>4*1 + 5*2 + 2*3 + 7*4
48
</code></pre><p>It is ok and I believe sage in this.</p>
<h2 id="switching-to-modulo">Switching to modulo.<a hidden class="anchor" aria-hidden="true" href="#switching-to-modulo">#</a></h2>
<p>Next step will be moving our linear system to modulo universe.<br>
We need to define matrix over some integer ring. We can choose a simple integer modulo, or Gaussian field over prime. It doesn&rsquo;t matter in this case, but let stay on safer side and choose modulo as a prime number and Gaussian Field for our next calculations. Choose modulo q = 23 and then matrix will be defined like this:</p>
<pre tabindex="0"><code>q = 23
A_gf = matrix(GF(q), (
    [4, 5, 2, 7],
    [7, 6, 4, 3],
    [5, 2, 0, 3],
    [9, 6, 4, 2],
))
</code></pre><p>Multiply it by expected solution:</p>
<pre tabindex="0"><code>A_gf * vector(GF(q), [1, 2, 3, 4])
(2, 20, 21, 18)
</code></pre><p>And we get right side. And congruences (not equations anymore) will looks like:</p>
<p>$4a_1 + 5a_2 + 2a_3 + 7a_4 \equiv 2  \space\space mod(23)$<br>
$7a_1 + 6a_2 + 4a_3 + 3a_4 \equiv 20  \space\space mod(23)$<br>
$5a_1 + 2a_2 + 0a_3 + 3a_4 \equiv 21  \space\space mod(23)$<br>
$9a_1 + 6a_2 + 4a_3 + 2a_4 \equiv 18  \space\space mod(23)$</p>
<p>We can check the first row:</p>
<pre tabindex="0"><code>(4*1 + 5*2 + 2*3 + 7*4) % 23
2
</code></pre><p>And it is ok.<br>
Let check also 2. row for those who are more suspicious.</p>
<pre tabindex="0"><code>(7*1 + 7*2 + 4*3 +3*4) % 23
22
</code></pre><p>And it still holds.<br>
We can employ sage&rsquo;s solver to check complete congruence system:</p>
<pre tabindex="0"><code>b_gf = vector(GF(q), [2, 20, 21, 18])
A_gf.solve_right(b_gf)
</code></pre><p>And output is as expected:</p>
<pre tabindex="0"><code>(1, 2, 3, 4)
</code></pre><p>This was necessary introduction to solving linear equations and linear congruences by sage.<br>
And we are ready to move to LWE now.</p>
<h2 id="lwe-introduction">LWE introduction<a hidden class="anchor" aria-hidden="true" href="#lwe-introduction">#</a></h2>
<p>Add 2 more congruences to our system to make it a bit overdetermined.</p>
<p>$4a_1 + 5a_2 + 2a_3 + 7a_4 \equiv 2  \space\space mod(23)$<br>
$7a_1 + 6a_2 + 4a_3 + 3a_4 \equiv 20  \space\space mod(23)$<br>
$5a_1 + 2a_2 + 0a_3 + 3a_4 \equiv 21  \space\space mod(23)$<br>
$9a_1 + 6a_2 + 4a_3 + 2a_4 \equiv 18  \space\space mod(23)$<br>
$3a_1 + 5a_2 + 7a_3 + 9a_4 \equiv 1  \space\space mod(23)$<br>
$0a_1 + 3a_2 + 6a_3 + 9a_4 \equiv 14  \space\space mod(23)$</p>
<pre tabindex="0"><code>A_gf = A_gf.stack(matrix(GF(q),([3, 5, 7, 9], [0, 3, 6, 9])))
A_gf * vector(GF(q), [1, 2, 3, 4])
# gives: (2, 20, 21, 18, 1, 14)
b_gf = vector(GF(q), [2, 20, 21, 18, 1, 14])
A_gf.solve_right(b_gf)
# gives again: (1, 2, 3, 4)
</code></pre><p>System holds and everything is consistent.<br>
<strong>But now try to inject small error to right side</strong>. Just change $2$ to $3$ in the first row.<br>
And now try to solve by sage&rsquo;s solver:</p>
<pre tabindex="0"><code>b_gf_err = vector(GF(q), [3, 20, 21, 18, 1, 14])
A_gf.solve_right(b_gf_err)
</code></pre><p>And we get error:</p>
<pre tabindex="0"><code>ValueError: matrix equation has no solutions
</code></pre><p>Expected. But the question is, if we are able to solve such intently broken overdetermined congruence system?
Indeed, it is a hard problem. Exactly what crypto systems need.<br>
How hard depends on scale of errors and number of unknowns in congruence system.</p>
<p>Ok, and as in other crypto systems, we need public key, private key, plaintext message and encrypted message.<br>
So what is what in LWE?   It is not as clear as in other crypto schemes but following is pretty close for better imagination:</p>
<p>Public key is a matrix - integer coefficients on left side of noisy congruence system.<br>
Private secret key is vector of unknowns. $a_1, a_2, a_3, a_4$ in our case. We worked with 1, 2, 3, 4.<br>
Plaintext secret message is vector of errors, which are injected to integers on right side.<br>
And right side we can consider as cipher message.</p>
<p>With knowledge of private key (vector of unknowns of congruences system) is it straightforward to solve the system. Difference between output on right side and provided solution (secret cipher message) is exactly error vector, which is plaintext message.</p>
<p>Without knowledge of private key, we have to try to solve noisy congruence system and try to identify injected errors.</p>
<p>Everything will be more clear in following real example.</p>
<h2 id="creating-lwe-system">Creating LWE system<a hidden class="anchor" aria-hidden="true" href="#creating-lwe-system">#</a></h2>
<p>I&rsquo;m going to create and solve noisy overdetermined LWE system. Let choose something bigger, but still solvable by Lattice.</p>
<h3 id="challenge-3">Challenge 3<a hidden class="anchor" aria-hidden="true" href="#challenge-3">#</a></h3>
<hr>
<p><strong>Create noisy system with encoded message first</strong><br>
Let generate matrix with 64 columns and 96 rows with random coefficients over field $q = 2^{16} + 1$.<br>
This matrix is a Public key.<br>
Let generate Private key as vector of 64 random numbers.<br>
Let choose plaintext message &ldquo;HelloLattice&rdquo; and encode it as 0 and 1 to error vector.<br>
Calculate correct right side of system by multiplying matrix with secret vector. <br>
Inject error vector to system.</p>
<p><strong>Challenge task:</strong><br>
Try to break system and decode plaintext without knowledge of private key.</p>
<hr>
<p>First part is straightforward. Just follow challenge steps to create noisy system:</p>
<pre tabindex="0"><code>q = 2**16 + 1
m = 96  # rows
n = 64  # columns

# public key as matrix 96x64
A = Matrix(GF(q), m, n, lambda i, j: randint(0, q))

# private key as vector of 64 numbers:
s = vector(Matrix(GF(q), 1, n, lambda i, j: randint(0, q)))

# define plaintext message and encode it to error vector e:  
message = &#34;HelloLattice&#34;
bits = [int(b) for c in message.encode(&#34;utf-8&#34;) for b in f&#34;{c:08b}&#34;]
e = vector(GF(q), bits)

# calculate correct right side of system:  
b_correct = A * s 

# and finally inject errors by adding correct right side and error vector:
b = b_correct + e
</code></pre><p>You can check all variables, but they are quite big, so I do not write outputs here.<br>
With knowledge of private key the solution should be easy.<br>
$e = b - A * s$<br>
Should give us cleartext message encoded in 0 and 1.<br>
Let try it:</p>
<pre tabindex="0"><code># calculate error vector - binary encoded message
e_exp = b - A * s

# and now try to decode
byte_values = []
for i in range(0, len(e_exp), 8):
    byte = int(&#34;&#34;.join(str(b) for b in e_exp[i:i+8]), 2)
    byte_values.append(byte)
print(&#34;Decoded message: &#34;, bytes(byte_values).decode(&#34;utf-8&#34;, errors=&#34;ignore&#34;))
</code></pre><p>And you should get correct plaintext message.<br>
Now we continue with hardest way. We are going to recover message without knowledge of private key s. And again we will utilize Lattice.</p>
<h2 id="solving-noisy-lwe-system-by-lattice">Solving noisy LWE system by Lattice<a hidden class="anchor" aria-hidden="true" href="#solving-noisy-lwe-system-by-lattice">#</a></h2>
<p>We know just system of linear equations (more precisely congruences), where right side tampered by errors. We know that error could be 1 or 0, so very small divergence from correct results. Nothing else. This error vector is encoded plaintext message. So we want to find it. In this case error vector is 96 bits long. Even errors are small, it is still $2^{96}$ possibilities, which is completely infeasible by brute force method.<br>
But keywords <strong>very small divergence</strong> from previous evaluation could lead us again to our topic - Lattice.</p>
<p>If LLL method can discover smallest non-zero vector in given Lattice, it could find unknown error vector.</p>
<pre tabindex="0"><code>A_zz = matrix(ZZ, A)
b_zz = vector(ZZ, b)
 
A_aug = A_zz.augment(b_zz).augment(diagonal_matrix(ZZ, [q] * m)).T
A_lll = A_aug.LLL()

for row in A_lll:
    if row != 0 and all(abs(x) &lt;= 1 for x in row):
        break       

# solve the system
e_exp = vector(Integers(q), row)
try:
    s_v = A.solve_right(b - e_exp)
    print(f&#34;*** System solvable: e = {e_exp}&#34;)
except:
    print(&#34;No solution found with LATTICE method.&#34;)
    s_v = None

byte_values = []
for i in range(0, len(e_exp), 8):
    byte = int(&#34;&#34;.join(str(b) for b in e_exp[i:i+8]), 2)
    byte_values.append(byte)
print(&#34;Decoded message: &#34;, bytes(byte_values).decode(&#34;utf-8&#34;, errors=&#34;ignore&#34;))
</code></pre>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href=/posts/Knapsack_and_Lattice>
    <span class="title">« PREVious in this series</span>
    <br>
    <span>Part 2: Knapsack_and_Lattice</span>
  </a>
</nav>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Noisy system solved by Lattice on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2flocalhost%3a1313%2fposts%2fnoisy_system_solved_by_lattice%2f&amp;title=Noisy%20system%20solved%20by%20Lattice&amp;summary=Noisy%20system%20solved%20by%20Lattice&amp;source=http%3a%2f%2flocalhost%3a1313%2fposts%2fnoisy_system_solved_by_lattice%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Noisy system solved by Lattice on reddit"
            href="https://reddit.com/submit?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fnoisy_system_solved_by_lattice%2f&title=Noisy%20system%20solved%20by%20Lattice">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">sbezo.github.io</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
